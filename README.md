# Отчет по устройству (PERCo)

Скрипт для автоматического получения данных из системы PERCo, формирования отчета в формате Excel и отправки его на email.

## Возможности

- Получение событий из системы PERCo за прошлый месяц или текущий месяц
- Формирование отчета в формате XLSX
- Отправка отчета на указанный email
- Логирование в файл и консоль
- Гибкая настройка через .env

## Требования

- Python 3.x
- Windows (используется win32com)
- PERCo SDK. Зарегистрированная dll PERCo_S20_SDK.dll. `regsvr32.exe "C:\Program Files (x86)\PERCo\PERCo-S-20\PERCo_S20_SDK.dll"`
- Установленные зависимости из `requirements.txt`
- Файл конфигурации `.env` с параметрами подключения
- Необходимо получить данные из системы PERCo и узнать ID устройства и ID события.

## Установка

1. Клонируйте репозиторий или скопируйте файлы в рабочую папку.
2. Создайте и активируйте виртуальное окружение:

   ```sh
   python -m venv venv
   venv\Scripts\activate
   ```

3. Установите зависимости:

```sh
pip install -r requirements.txt
```

1. Заполните файл `.env` своими параметрами подключения (см. пример).

## Запуск

```sh
python main.py <email>
```

Например:

```sh
python main.py user@example.com
```

## Логи

Все события и ошибки пишутся в файл `percopy.log` и выводятся в консоль.

## Примечания

- Для работы с PERCo SDK требуется установленная библиотека PERCo_S20_SDK.
- Скрипт работает только на Windows.
